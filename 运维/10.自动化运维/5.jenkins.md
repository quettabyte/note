## jenkins

### 一、jenkins安装

#### 1、安装jdk

```
[root@jenkins ~]# tar xf jdk-8u91-linux-x64.tar.gz -C /usr/local/
[root@jenkins ~]# vim /etc/profile
export JAVA_HOME=/usr/local/jdk1.8.0_91
export PATH=$PATH:$JAVA_HOME/bin
[root@jenkins ~]# source /etc/profile

[root@jenkins ~]# java -version
java version "1.8.0_91"
Java(TM) SE Runtime Environment (build 1.8.0_91-b14)
Java HotSpot(TM) 64-Bit Server VM (build 25.91-b14, mixed mode)

```

#### 2、安装jenkins

```
[root@jenkins ~]# rpm -ivh jenkins-2.277-1.1.noarch.rpm 
warning: jenkins-2.277-1.1.noarch.rpm: Header V4 RSA/SHA512 Signature, key ID 45f2c3d5: NOKEY
Preparing...                          ################################# [100%]
Updating / installing...
   1:jenkins-2.277-1.1                ################################# [100%]

```

#### 3、修改jenkins启动脚本，添加java的路径 

```
[root@jenkins ~]# vim /etc/init.d/jenkins 

candidates="
/etc/alternatives/java
/usr/lib/jvm/java-1.8.0/bin/java
/usr/lib/jvm/jre-1.8.0/bin/java
/usr/lib/jvm/java-11.0/bin/java
/usr/lib/jvm/jre-11.0/bin/java
/usr/lib/jvm/java-11-openjdk-amd64
/usr/bin/java
/usr/local/jdk1.8.0_91/bin/java
"
[root@jenkins ~]# systemctl daemon-reload
[root@jenkins ~]# systemctl start jenkins
[root@jenkins ~]# systemctl enable jenkins

[root@jenkins ~]# netstat -antp | grep java
tcp6       0      0 :::8080                 :::*                    LISTEN      9520/java    
```

#### 4、修改插件下载地址

```
[root@jenkins ~]# cat /var/lib/jenkins/hudson.model.UpdateCenter.xml
<?xml version='1.1' encoding='UTF-8'?>
<sites>
  <site>
    <id>default</id>
    <url>http://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</url>
  </site>
</sites>

[root@jenkins ~]# systemctl restart jenkins
```

#### 5、访问jenkins界面 

```
http://192.168.140.10:8080
```

![image-20210324105541326](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210324105541326.png)

![image-20210324105656945](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210324105656945.png)

![image-20210324105854831](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210324105854831.png)

![image-20210324105923800](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210324105923800.png)

#### 6、升级jenkins到最新版本

```
[root@jenkins ~]# cp jenkins.war /usr/lib/jenkins/
cp: overwrite ‘/usr/lib/jenkins/jenkins.war’? yes

[root@jenkins ~]# ls /usr/lib/jenkins/
jenkins.war

[root@jenkins ~]# systemctl restart jenkins

```

#### 7、修改default.json文件，将国内的地址修改为国内插件地址

```
[root@jenkins ~]# sed -i 's/https:\/\/updates.jenkins.io\/download/http:\/\/mirrors.tuna.tsinghua.edu.cn\/jenkins/g' /var/lib/jenkins/updates/default.json && sed -i 's/http:\/\/www.google.com/https:\/\/www.baidu.com/g' /var/lib/jenkins/updates/default.json

[root@jenkins ~]# systemctl restart jenkins

```

#### 8、安装汉化的插件

![image-20210324110636870](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210324110636870.png)

