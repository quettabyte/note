## request.FILES实现文件上传

### 一、 作用

```
作用： 实现文件上传 
```

```
request.FILES字典获取上传文件对象

上传对象具有的属性和方法:

	1、obj.name		字符串类型的文件名
	2、obj.chunks()	
		返回的生成器对象，包含文件中的实体数据
```

##### templates/testapp/filepush.html

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>文件上传</title>
</head>
<body>

    <form action="/testapp/filepush/" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <input type="file" name="testfile" />
        <input type="submit" value="上传"/>

    </form>

</body>
</html>
```

##### YWproject/urls.py

```
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('testapp/', include('testapp.urls')),
]
```

##### testapp/urls.py

```
from django.contrib import admin
from django.urls import path, include
from testapp import views


urlpatterns = [
    path('filepush/', views.filepush),
]
```

##### testapp/views.py

```
from django.shortcuts import render, redirect
from django.http import HttpResponse

# Create your views here.

# 演示文件上传功能
def filepush(request):
    if request.method == "GET":
        return render(request, "testapp/filepush.html")
    elif request.method == "POST":
        # 实现文件上传
        upload_dir = r"D:\20201207\YWproject\upload"
        upload_file_obj = request.FILES.get("testfile")
        file_name = upload_file_obj.name

        # 在项目本地创建同名的文件，写入数据
        import os
        os.chdir(upload_dir)
        with open(file_name, mode="wb") as fobj:
            for data in upload_file_obj.chunks():
                fobj.write(data)
        return HttpResponse("文件上传完成 !!!!")
```







#### 案例: 文件上传

##### templates/fileManager/upload.html

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>上传文件功能</title>
</head>
<body>

    <h3>文件发布</h3>

    <div>
        <form action="/file/upload/" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <span>服务器地址(以逗号隔开写多个地址): </span>
            <input type="text" name="ip" />

            <span>源文件: </span>
            <input type="file" name="uploadfile" />

            <span>服务器目录: </span>
            <input type="text" name="server_dir"/>

            <input type="submit" value="上传"/>
        </form>
    </div>

</body>
</html>
```

