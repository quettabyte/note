## 正则表达式——re模块

### 一、正则表达式

```
作用: 
	1、过滤数据 
	2、数据验证
```

#### 1、匹配单个字符的元字符

```
.	任意单个字符
\d	[0-9]	任意单个数字
	\D
\w	[a-zA-Z0-9_]	任意单个数字、字母、下划线 
	\W
\s	任意单个空白字符 
	\S
```

#### 2、匹配字符出现的次数

```
*	任意次		ab*
+	至少一次	
?	可有可无
{3}	精确3次
	{2,4}
	{2,}
```

#### 3、分组

```
()
(abc)?
```

#### 4、匹配字符出现的位置

```
^string		以string开头
string$		以string结尾 
```

#### 5、?的含义

```
1、次数
2、如果?跟在一个表示次数的元字符后，以非贪婪模式匹配数据
	贪婪模式	默认
		按最长匹配
	非贪婪模式
		按最短匹配
```



### 二、re模块

#### 1、search(pattern, string)

```
在整个字符串中扫描可以被正则表达式匹配的数据
如果能匹配，返回Match object匹配对象, 否则返回None
```

```
import re

data_01 = "python like golang"

test_re_01 = r"l..e"
test_re_02 = r"K..e"

result_01 = re.search(test_re_01, data_01)
result_02 = re.search(test_re_02, data_01)

print(result_01)
print(result_02)
```

```
import re

data_01 = "python like golang"

test_re_01 = r"l..e"

result = re.search(test_re_01, data_01)

if result:
    print("可以匹配数据")
else:
    print("无数据匹配")
```

##### 获取实体数据可借助Match object提供的方法

###### 1) Match object.group()		以字符串的形式返回正则表达式匹配到的所有数据  

```
import re

data_01 = "python like golang"

test_re_01 = r"l..e"

result = re.search(test_re_01, data_01)

if result:
    print("可以匹配数据")
    content = result.group()
    print(content)
    print(type(content))
else:
    print("无数据匹配")
```

###### 2) Match object.groups()   

```
以元组的形式返回正则表达式中分组对应的数据  
```

```
import re

data_01 = "python like golang"

test_re_01 = r"l(.)(.)e"

result = re.search(test_re_01, data_01)

if result:
    print("可以匹配数据")
    content_01 = result.group()
    print(content_01)
    print(type(content_01))

    content_02 = result.groups()
    print(content_02)
else:
    print("无数据匹配")


```

###### 3) Match object.groupdict( )

```
1、正则表达式要有分组
2、分组要进行命名	(?P<组名>........)
```

```
import re

data_01 = "python like golang"

test_re_01 = r"l(?P<第一个字符>.)(?P<第二个字符>.)e"

result = re.search(test_re_01, data_01)

if result:
    print("可以匹配数据")
    content_01 = result.group()
    print(content_01)
    print(type(content_01))

    content_03 = result.groupdict()
    print(content_03)
else:
    print("无数据匹配")
```



#### 2、findall(pattern, string)

```
以列表的形式返回正则表达式匹配的所有数据 
```

```
import re

data_01 = "python like class, lyz love dog"

test_re = r"l..e"

result = re.findall(test_re, data_01)

print(result)
```



#### 3、split(pattern, string)

```
以正则表达式匹配的字符分割字符串
```

```
import re

data_01 = "root     pts/0        2021-04-21 15:39 (10.10.11.240)"

test_re = r"\s{2,}"

result = re.split(test_re, data_01)

print(result)
```



#### 4、sub(pattern, new, string)

```
将字符串被正则表达式匹配的数据替换为新数据 
```

```
import re

url_list = [ "http://192.168.1.1/logo.jpg", "http://1.1.1.1/test", "http://10.1.1.1/upload" ]

ip_regex  = r"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"

for url in url_list:
    new_url = re.sub(ip_regex, "test.linux.com", url)
    print(new_url)
```



#### 示例1: 获取邮箱地址

```
import re

file_name = r"D:\20201207\project1207\files\test04.txt"
email_re = r"\w+@\w+\.\w+(\.\w+)?"

with open(file_name, mode="r") as fobj:
    for line in fobj:
        result = re.search(email_re, line)
        if result:
            print(result.group())
```



#### 示例2: 统计webUV

```
import re

web_log = r"D:\20201207\project1207\files\access_log"
ip_re = r"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"

# 获取所有客户端地址
ip_list = []
with open(web_log, mode="r") as fobj:
    for line in fobj:
        result = re.search(ip_re, line)
        if result:
            client_ip = result.group()
            ip_list.append(client_ip)

# 统计IP地址的次数
for ip in frozenset(ip_list):
    print("客户端地址: %s, 次数: %s" % (ip, ip_list.count(ip)))
```



#### 示例3: 统计webPV

```
import re

web_log = r"D:\20201207\project1207\files\access_log"
page_re = r"\s/.*?\s"

# 从日志中获取所有访问页面
page_list = []
with open(web_log, mode="r") as fobj:
    for line in fobj:
        result = re.search(page_re, line)
        if result:
            page = result.group()
            page_list.append(page)

# 统计页面的次数
for page in frozenset(page_list):
    print("页面: %s, 次数: %s" % (page, page_list.count(page)))

```















