## nginx

### 一、nginx介绍

#### 1、作用

```
作用:
	1、作为web服务器应用
		高并发C10K、速度快
	2、反向代理服务器 【web服务、mail邮件服务】
		1) 一定程度提升服务器的安全
		2) 利用缓存功能，提升访问速度 
		3) 高并发
```

#### 2、特性

```
http://nginx.org/
```

```
1、跨平台的、开源
2、支持虚拟主机、认证功能、https、url重写
3、负载均衡、缓存功能
4、模块化
5、支持异步IO模型
6、支持epoll事件驱动模型 
```



### 二、异步IO模型 

#### 1、根据进程处理IO请求操作的方式 

```
同步

异步
```



#### 2、根据进程处理磁盘IO操作方式 

```
非阻塞
	进程在等待磁盘IO时，同时可以处理其他数据

阻塞
	进程等待磁盘IO完成
```



### 三、epoll事件驱动模型

#### 1、select

```
采用周期性询问的方式工作
有文件数量的限制  1024
```

#### 2、poll

```
采用周期性询问的方式工作
无文件数量的限制
```

#### 3、epoll

```
采用通知机制
```





### 四、nginx安装

#### 1、源码编译安装nginx

```
[root@localhost ~]# yum install -y gcc openssl-devel pcre-devel zlib-devel 

[root@localhost nginx-1.18.0]# useradd -s /sbin/nologin -M nginx
[root@localhost nginx-1.18.0]# mkdir -p /var/tmp/nginx/{client,proxy,fastcgi,uwsgi,scgi}

[root@localhost ~]# tar xf nginx-1.18.0.tar.gz 
[root@localhost ~]# cd nginx-1.18.0/
[root@localhost nginx-1.18.0]# ./configure --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module --with-http_flv_module --with-http_stub_status_module --with-http_gzip_static_module --http-client-body-temp-path=/var/tmp/nginx/client/ --http-proxy-temp-path=/var/tmp/nginx/proxy/ --http-fastcgi-temp-path=/var/tmp/nginx/fastcgi/ --http-uwsgi-temp-path=/var/tmp/nginx/uwsgi/ --http-scgi-temp-path=/var/tmp/nginx/scgi/ --with-pcre --with-file-aio --with-http_secure_link_module --with-threads
[root@localhost nginx-1.18.0]# make 
[root@localhost nginx-1.18.0]# make install 
```

#### 2、nginx目录结构

```
1、存放nginx命令的路径 
	安装目录/sbin
	
2、存放配置文件
	安装目录/conf		主配置文件: nginx.conf 
	
3、存放日志文件
	安装目录/logs
	
4、默认网页目录
	安装目录/html
```





### 五、nginx启动管理 



#### 1、启动nginx

```
[root@localhost ~]# /usr/local/nginx/sbin/nginx 

[root@localhost ~]# ps -elf | grep nginx
1 S root       4063      1  0  80   0 - 11499 sigsus 11:03 ?        00:00:00 nginx: master process /usr/local/nginx/sbin/nginx
5 S nginx      4064   4063  0  80   0 - 11612 ep_pol 11:03 ?        00:00:00 nginx: worker process
0 R root       4066   1025  0  80   0 - 28203 -      11:04 pts/0    00:00:00 grep --color=auto nginx
 
[root@localhost ~]# netstat -antp | grep nginx
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      4063/nginx: master  
```

##### 设置nginx开机自启动 

```
[root@localhost ~]# sed -ri '$a \/usr/local/nginx/sbin/nginx' /etc/rc.d/rc.local 
[root@localhost ~]# chmod a+x /etc/rc.d/rc.local
```



#### 2、停止nginx

```
[root@localhost ~]# /usr/local/nginx/sbin/nginx -s stop 
```



#### 3、重新加载配置文件

```
[root@localhost ~]# /usr/local/nginx/sbin/nginx -s reload 
```



#### 4、检测配置文件语法 

```
[root@localhost ~]# /usr/local/nginx/sbin/nginx -t
nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok
nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful
```



#### 5、查看nginx版本

```
[root@localhost ~]# /usr/local/nginx/sbin/nginx -v
nginx version: nginx/1.18.0
```



#### 6、查看nginx安装参数

```
[root@localhost ~]# /usr/local/nginx/sbin/nginx -V
nginx version: nginx/1.18.0
built by gcc 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC) 
built with OpenSSL 1.0.2k-fips  26 Jan 2017
TLS SNI support enabled
configure arguments: --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module --with-http_flv_module --with-http_stub_status_module --with-http_gzip_static_module --http-client-body-temp-path=/var/tmp/nginx/client/ --http-proxy-temp-path=/var/tmp/nginx/proxy/ --http-fastcgi-temp-path=/var/tmp/nginx/fastcgi/ --http-uwsgi-temp-path=/var/tmp/nginx/uwsgi/ --http-scgi-temp-path=/var/tmp/nginx/scgi/ --with-pcre --with-file-aio --with-http_secure_link_module --with-threads
```



















